<meta charset="UTF-8">
<h3 class="title">{{pagina.titulo}}</h3>

<fieldset class="fieldset well">
   <legend>Filtro</legend>
   <!-- Dados da emprensa-->
   <div class="panel panel-group">
      <div class="panel-default">
         <div class="panel-heading">
            <h5 class="panel-title">
               <i class="glyphicon glyphicon-search"></i><a  href="" ng-click="view.busca = true;">Busca simples</a>
            </h5>
         </div>
         <div class="panel-body" ng-show="view.busca">
            <div class="row">
               <div class="col-lg-9 pull-left">
                  <div class="input-group">
                     <input type="text" class="form-control"
                            placeholder="{{view.placeholder}}" name="filtroUnico"
                            ng-model="view.filtroUnico" ng-keypress="onKeyPressListar($event)">
                     <span class="input-group-btn"> <a href
                                                       class="btn btn-primary" type="button"
                                                       ng-click="onClickListar(false)"><i
                              class="glyphicon glyphicon-search"></i>&nbsp;Buscar</a>
                     </span>
                  </div>
               </div> 
            </div>
         </div>
      </div>
      <div class=" panel-default">
         <div class="panel-heading">
            <h5 class="panel-title">
               <i class="glyphicon glyphicon-search"></i>
               <a  href="" ng-click="view.busca = false;">Busca Avancada</a>
            </h5>
         </div>
         <div class="panel-body" ng-hide="view.busca">
            <div class="row">
               <div class="col-lg-3">
                  <label for="pedido">Nº Pedido </label>
                  <input type="text" id="pedido" name="pedido" ng-model="dados.pedido" class="form-control" maxlength="10">
               </div> 
               <div class="col-lg-3">
                  <label for="situacao">Situação</label>
                  <select id="situacao"
                          chosen class="form-control" ng-model="dados.situacao_id"
                          ng-options="item.id as item.descricao for item in toList(dadosLov.situacao)">
                     <option value="">***Selecione***</option>
                  </select>
               </div>
               <div class="col-lg-3">
                  <label for="placa">Placa</label>
                  <input  type="text"  id="placa" ng-model="dados.placa" name="placa" class="form-control" maxlength="7">
               </div>



               <div class="col-lg-3">
                  <label for="categoria">Categoria*</label>
                  <select id="categoria"
                          chosen no-results-text="'Sem resultados para:'" class="form-control"
                          ng-model="dados.categoria_id" 
                          ng-options="item.id as item.descricao for item in toList(dadosLov.categoria)">
                     <option value="">***Selecione***</option>
                  </select>
               </div>
            </div>
            <div class="row">           
               <div class="col-lg-5">
                  <label for="Cliente">Nome Cliente</label>
                  <input  type="text" ng-model="dados.cliente"  id="Cliente" name="Cliente" class="form-control" maxlength="20">
               </div>
               <div class="col-lg-2">
                  <label for="categoria">Data1</label>
                  <div class="input-group date">
                     <input id="data2" type="text" mask-input="99/99/9999" datepicker2
                            class="form-control" name="DataFundacao" ng-model="dados.data1">
                     <span class="input-group-addon"><i
                           class="glyphicon glyphicon-th"></i></span>
                  </div>
               </div>  
               <div class="col-lg-2">
                  <label for="categoria">Data2</label> 
                  <div class="input-group date">
                     <input id="data2" type="text" mask-input="99/99/9999" datepicker2
                            class="form-control" name="DataFundacao" ng-model="dados.data2">
                     <span class="input-group-addon"><i
                           class="glyphicon glyphicon-th"></i></span>
                  </div>
               </div>
               <div class="col-lg-3">               
                  <span class="btn-group  pull-right" style="margin-top:30px;">
                     <input type="button"  value="Limpar" class="btn btn-default" ng-click="dados = {}">
                     <a href="" class="btn btn-primary" type="button"
                        ng-click="onClickListarAvancada(false)">
                        <i class="glyphicon glyphicon-search"></i>&nbsp;Buscar Avançada
                     </a>
                  </span> 

               </div>
            </div>
         </div>   
      </div>
   </div>
   <div class="row">
      <div class="col-lg-1 col-lg-offset-11" ng-show="UserNivel().In(1, 2)">
         <a href="#/pedido/new" class="btn btn-success pull-right"><i
               class="glyphicon glyphicon-file"></i>&nbsp;Cadastrar</a>
      </div></div>
</fieldset>

<!-- Usuarios cadastrados-->
<fieldset class="fieldset well">
   <legend>{{pagina.legenda}}</legend>
   <div class="row">
      <div class="col-lg-12">       
         <div id="flip-scroll">
            <table datatable ng-source="view.dados "
                   class="table table-bordered table-striped table-hover table-condensed cf"
                   id="GridView1">
               <thead>
                  <tr class="title-table">
                     <th class="col-lg-1">N° Pedido</th>
                     <th class="col-lg-2">Descrição</th>
                     <th class="col-lg-2">Cliente</th>
                     <th class="col-lg-2">Situação</th>
                     <th class="col-lg-2">Categoria</th>
                     <th class="col-lg-1">Solicição</th>
                     <th class="col-lg-1" title="Quantidade de Orçamento">{{
                              UserNivel().In(3) ? 'Resposta' : 'Orçamento'}}</th>
                     <th class="col-lg-1">Ações</th>
                  </tr>
               </thead>
               <tbody>
                  <tr ng-repeat="item in view.dados">
                     <td>{{item.id}}</td>
                     <td title="{{item.observacao}}">{{item.observacao|
								setMaxLength:24}}<br/> <strong>Placa</strong> - {{item.placa}}</td>
                     <td title="{{item.cliente}}">{{item.cliente|
								setMaxLength:24}}</td>
                     <td title="{{item.situacao_descricao}}"><span
                           ng-class="(item.situacao_id==='3')?'color-blue':
											(item.situacao_id === '4')?'color-red':
											(item.situacao_id==='5')?'color-green':
											(item.situacao_id==='6')?'color-orange':
											(item.situacao_id==='7')?'color-purple':
											'color-black'">
                           {{item.situacao_id}} - {{item.situacao_descricao}} <br/> </span> {{(item.situacao_id.In(5, 7) && UserNivel().In(3)) ? item.meu_estabelecimento.In(1) ? '(Meu Orçamento Aprovado)' : '(Orçamento Reprovado)' : ''}}</td>
                     <td  title="{{item.categoria_descricao}}">{{item.categoria_descricao
                                         | setMaxLength:29}}</td>
                     <td>{{item.data_criacao}}</td>
                     <td align="center">{{ UserNivel().In(3) ?
                                         (item.qtd_orcamento_estabelecimento > 0 && item.qtd_orcamento
                                                 > 0) ? 'Respondido' : 'Aguardando Resposta' : item.qtd_orcamento}}</td>
                     <td>
                        <!-- Visualizar -->
                        <a href="#/pedido/visualizar/{{item.id}}"
                           class="btn btn-default btn-xs" title="Visualizar dados do pedido">
                           <i class="glyphicon glyphicon-eye-open"></i>
                        </a>
                        <!-- Editar -->
                        <a href="#/pedido/editar/{{item.id}}"
                           class="btn btn-default btn-xs" title="Editar"
                           ng-show="item.situacao_id.In(10) && UserAtivo().In(1)">
                           <i class="glyphicon glyphicon-pencil"></i>
                        </a>						
                        <!-- Enviar -->
                        <a href=""	ng-click="onClickEnviar(item.id, $index)"
                           class="btn btn-default btn-xs" title="Enviar"
                           ng-show="item.situacao_id.In(10) && UserAtivo().In(1)">
                           <i class="glyphicon glyphicon-open"></i>
                        </a>
                        <!-- Cancelar -->
                        <a ng-click="onClickCancelar(item.id, $index)"
                           class="btn btn-default btn-xs" title="Cancelar"
                           ng-show="item.situacao_id.In(3, 6) && UserNivel().In(1, 2) && UserAtivo().In(1)">
                           <i class="glyphicon glyphicon-ban-circle"></i>
                        </a>
                        <!-- Gerênciar --> 
                        <a ng-href="#/orcamento/pedido_id={{item.id}}&cliente_id={{item.cliente_id}}"
                           class="btn btn-default btn-xs" title="Detalhar Orçamento(s)"
                           ng-show="item.situacao_id.In(3, 5, 6, 7) && (item.qtd_orcamento > 0 || UserNivel().In(1, 2, 3)) && ((item.qtd_orcamento_estabelecimento > 0 && UserNivel().In(3)) || (item.qtd_orcamento > 0 && UserNivel().In(1, 2)))">
                           <i class="glyphicon glyphicon-list-alt"></i>
                        </a>

                        <!-- imprimir -->
                        <a  visualizar-relatorio="Relatorio/RelatorioOrcamentoAprovado/{{item.id}}"
                            class="btn btn-default btn-xs" title="Visualizar Relatório"
                            ng-show="item.situacao_id.In(5) && (item.meu_estabelecimento.In(1) || UserNivel().In(1, 2))">
                           <i class="glyphicon glyphicon-print"></i>
                        </a>												
                        <!-- Responder --> 
                        <a href="#/orcamento/editar/pedido_id={{item.id}}&id=0&cliente_id={{item.cliente_id}}"
                           class="btn btn-default btn-xs" title="Responder"
                           ng-show="item.situacao_id.In(3, 6) && UserNivel().In(1, 3) && item.qtd_orcamento_estabelecimento.In(0) && UserAtivo().In(1)">
                           <i class="glyphicon glyphicon-paperclip"></i>
                        </a>
                     </td>
                  </tr>
               </tbody>
            </table>
         </div>
      </div>
   </div>
</fieldset>
<!--<script type="text/javascript" src="app-controller/pedido-listar.js"></script>-->